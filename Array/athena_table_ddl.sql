CREATE EXTERNAL TABLE rtd_mart.fct_corep_crd4_stg(
YEAR_MONTH_RK int,
DEAL_ID string,
MITIGANT_ID string,
SYS_CODE string, 
REPORTING_REGULATOR_CODE string,
WALKER_COST_CENTRE_RK int,
COUNTERPARTY_RK int,
LE_COUNTERPARTY_RK int,
WBU_COUNTERPARTY_RK int,
DIVISION_RK int,
INCORP_COUNTRY_RK int,
OP_COUNTRY_RK int,
RISK_COUNTRY_RK int,
BRANCH_COUNTRY_RK int,
B2_IRB_ASSET_CLASS_RK int,
COREP_ASSET_CLASS_RK int,
COREP_STD_ASSET_CLASS_RK int,
COREP_PRDEF_STD_ASSET_CLASS_RK int,
B2_STD_ASSET_CLASS_RK int,
PRODUCT_RK int,
COREP_PRODUCT_CATEGORY_RK int,
PD_MODEL_RK int,
COUNTERPARTY_MGS_PD_BAND_RK int,
CBI_PD_BAND_CODE_RK int,
MGS_PD_BAND_CODE_RK int,
RET_PD_BAND_CODE_RK int,
RRU_RK int,
RISK_ON_RRU_RK int,
UNSETTLED_PERIOD_CODE int,
UNSETTLED_FACTOR_CODE int,
RUN_RK int,
ACCRUED_INT_ONBAL_AMT float,
ACCRUED_INTEREST_GBP float,
ACLM_PRODUCT_TYPE string,
ADJUST_FLAG string,
REPORTING_TYPE_CODE string,
RWA_APPROACH_CODE string,
B1_RWA_POST_CRM_AMT float,
B2_APP_ADJUSTED_LGD_RATIO float,
B2_APP_ADJUSTED_PD_RATIO float,
B2_APP_EXPECTED_LOSS_AMT float,
B2_APP_RISK_WEIGHT_RATIO float,
B2_IRB_CRM_FCP_ELG_FIN_COL_AMT float,
B2_IRB_CRM_FCP_OTH_PHY_COL_AMT float,
B2_IRB_CRM_FCP_OTH_FUNDED_AMT float,
B2_IRB_CRM_FCP_REAL_ESTATE_AMT float,
B2_IRB_CRM_FCP_RECEIVABLES_AMT float,
B2_IRB_CRM_UFCP_CRED_DERIV_AMT float,
B2_IRB_CRM_UFCP_DOUBLE_DEF_AMT float,
B2_IRB_CRM_UFCP_GUAR_AMT float,
B2_IRB_DEFAULT_DATE string,
B2_IRB_DRAWN_EAD float,
B2_IRB_DRAWN_EXPECTED_LOSS float,
B2_IRB_DRAWN_RWA float,
B2_IRB_EAD_AMT_OFBAL float,
B2_IRB_EAD_AMT_ONBAL float,
B2_IRB_EL_AMT_OFBAL float,
B2_IRB_EL_AMT_ONBAL float,
B2_IRB_NETTED_COLL_GBP float,
B2_IRB_OBSRVD_NEW_DEFAULT_FLAG string,
B2_STD_OBSRVD_NEW_DEFAULT_FLAG string,
B2_IRB_ORIG_EXP_PRE_CON_FACTOR float,
B2_IRB_PROVISIONS_AMT float,
B2_IRB_RWA_AMT_OFBAL float,
B2_IRB_RWA_AMT_ONBAL float,
B2_IRB_UNDRAWN_EAD float,
B2_IRB_UNDRAWN_EXPECTED_LOSS float,
B2_IRB_UNDRAWN_RWA float,
B2_STD_CCF float,
B2_STD_CCF_LESS_THAN_YEAR float,
B2_STD_CCF_MORE_THAN_YEAR float,
B2_STD_COLL_FX_HAIRCUT_AMT float,
B2_STD_COLL_VOLATILITY_AMT float,
B2_STD_CRM_TOT_INFLOW float,
B2_STD_CRM_TOT_INFLOW_OFBAL float,
B2_STD_CRM_TOT_INFLOW_ONBAL float,
B2_STD_CRM_TOT_INFLOW_RWA float,
B2_STD_CRM_TOT_OUTFLOW float,
B2_STD_CRM_TOT_OUTFLOW_OFBAL float,
B2_STD_CRM_TOT_OUTFLOW_ONBAL float,
B2_STD_CRM_TOT_OUTFLOW_RWA float,
B2_STD_DEFAULT_DATE string,
B2_STD_DRAWN_EAD float,
B2_STD_DRAWN_RWA float,
B2_STD_EAD_POST_CRM_AMT_OFBAL float,
B2_STD_EAD_POST_CRM_AMT_ONBAL float,
B2_STD_EFF_CDS_AMT float,
B2_STD_EFF_FIN_COLL_AMT float,
B2_STD_EFF_GTEE_AMT float,
B2_STD_COLL_MTY_MISMATCH_AMT float,
B2_STD_EXP_HAIRCUT_ADJ_AMT float,
B2_STD_EXPOSURE_VALUE float,
B2_STD_EXPOSURE_VALUE_OFBAL float,
B2_STD_EXPOSURE_VALUE_ONBAL float,
B2_STD_FULLY_ADJ_EXP float,
B2_STD_FULLY_ADJ_EXP_CCF_0 float,
B2_STD_FULLY_ADJ_EXP_CCF_100 float,
B2_STD_FULLY_ADJ_EXP_CCF_20 float,
B2_STD_FULLY_ADJ_EXP_CCF_50 float,
B2_STD_FULLY_ADJ_EXP_OFBAL float,
B2_STD_FULLY_ADJ_EXP_ONBAL float,
B2_STD_NET_EXP_POST_CRM_SUBST float,
STD_NET_EXP_POSTCRM_SUBT_OFBAL float,
STD_NET_EXP_POSTCRM_SUBT_ONBAL float,
B2_STD_NET_EXP_PRE_CRM_SUBST float,
STD_NET_EXP_PRECRM_SUBST_OFBAL float,
STD_NET_EXP_PRECRM_SUBST_ONBAL float,
B2_STD_NETTED_COLL_GBP float,
B2_STD_ORIG_EXP_PRE_CON_FACTOR float,
B2_STD_OTH_FUN_CRED_PROT_AMT float,
B2_STD_PROVISIONS_AMT float,
B2_STD_PROVISIONS_AMT_OFBAL float,
B2_STD_PROVISIONS_AMT_ONBAL float,
B2_STD_RISK_WEIGHT_INDICATOR string,
B2_STD_RISK_WEIGHT_RATIO float,
B2_STD_RWA_AMT float,
B2_STD_RWA_AMT_OFBAL float,
B2_STD_RWA_AMT_ONBAL float,
B2_STD_RWA_POST_CRM_AMT_OFBAL float,
B2_STD_RWA_POST_CRM_AMT_ONBAL float,
B2_STD_UNDRAWN_EAD float,
B2_STD_UNDRAWN_RWA float,
B3_CCP_MARGIN_INITL_CASH_AMT float,
B3_CCP_MARGIN_INITL_NOCASH_AMT float,
B3_CCP_MARGIN_INITL_RWA_AMT float,
B3_CCP_MARGIN_NONINITL_RWA_AMT float,
B3_CVA_CC_ADV_FLAG string,
B3_CVA_PROVISION_AMT float,
B3_CVA_PROVISION_RESIDUAL_AMT float,
BASEL_DATA_FLAG string,
COLL_GOOD_PROV_AMT float,
COMM_LESS_THAN_1_YEAR float,
COMM_LESS_THAN_1_YR_APPORTION float,
COMM_MORE_THAN_1_YEAR float,
COMM_MORE_THAN_1_YR_APPORTION float,
CRD4_REP_CVA_FLAG string,
CRD4_REP_IRB_FLAG string,
CRD4_REP_IRBEQ_FLAG string,
CRD4_REP_SETTL_FLAG string,
CRD4_REP_STD_FLAG string,
CRD4_REP_STDFLOW_FLAG string,
CVA_CHARGE float,
DEFAULT_FUND_CONTRIB_INDICATOR string,
DOUBLE_DEFAULT_FLAG string,
EAD_LGD_NUMERATOR float,
EAD_LGD_NUMERATOR_OFF float,
EAD_LGD_NUMERATOR_ON float,
EAD_MAT_YEARS_NUMERATOR float,
EAD_MAT_YEARS_NUMERATOR_OFF float,
EAD_MAT_YEARS_NUMERATOR_ON float,
EAD_PD_NUMERATOR float,
EAD_PD_NUMERATOR_OFF float,
EAD_PD_NUMERATOR_ON float,
EAD_POST_CRM_AMT float,
EAD_PRE_CRM_AMT float,
EXCH_RATE_EUR float,
EXCH_RATE_USD float,
FLOW_TYPE string,
GROSS_DEP_UTILISATION_AMT float,
IMP_IMPAIRMENT_AMT float,
IMP_WRITE_OFF_AMT float,
INTERNAL_TRANSACTION_FLAG string,
IRB_ORIG_EXP_PRE_CONV_OFBAL float,
IRB_ORIG_EXP_PRE_CONV_ONBAL float,
IRB_RISK_WEIGHT_RATIO float,
LRFE_UFE_FLAG string,
NET_DEP_UTILISATION_AMT float,
NET_EXPOSURE float,
NET_EXPOSURE_POST_SEC float,
OBLIGOR_TYPE string,
OFF_BAL_LED_EXP_GBP_POST_SEC float,
OFF_BALANCE_EXPOSURE float,
ON_BAL_LED_EXP_GBP_POST_SEC float,
ON_BALANCE_LEDGER_EXPOSURE float,
PAST_DUE_ASSET_FLAG string,
PROVISION_AMOUNT_GBP float,
QCCP_FLAG string,
RESIDUAL_MATURITY_DAYS float,
RESIDUAL_VALUE float,
RETAIL_OFF_BAL_SHEET_FLAG string,
RISK_ON_GROUP_STRUCTURE string,
RISK_TAKER_GROUP_STRUCTURE string,
RWA_CALC_METHOD string,
RWA_POST_CRM_AMOUNT float,
SECURITISED_FLAG string,
SET_OFF_INDICATOR string,
SLOTTING_RESIDUAL_MATURITY string,
SME_FLAG string,
SRT_FLAG string,
STD_ORIG_EXP_PRE_CONV_OFBAL float,
STD_ORIG_EXP_PRE_CONV_ONBAL float,
STD_RISK_WEIGHT_RATIO float,
TRADING_BOOK_FLAG string,
UNDRAWN_COMMITMENT_AMT float,
UNDRAWN_COMMITMENT_AMT_PST_SEC float,
UNSETTLED_AMOUNT float,
UNSETTLED_PRICE_DIFFERENCE_AMT float,
LEASE_EXPOSURE_GBP float,
LEASE_PAYMENT_VALUE_AMT float,
RETAIL_OBLIGOR_COUNT int,
STD_EXPOSURE_DEFAULT_FLAG string, 
STD_EXP_TYPE_PRI_ORDER_RULE_RK int,
CRD4_SOV_SUBSTITUTION_FLAG string,
STD_RW_PRIORITY_ORDER_RULE_RK int,
UNLIKELY_PAY_FLAG string,
CRD4_STD_RP_SME_FLAG string,
CRD4_IRB_RP_SME_FLAG string,
STD_SME_DISCOUNT_APP_FLAG string,
IRB_SME_DISCOUNT_APP_FLAG string,
TRANSITIONAL_PORTFOLIO_FLAG string,
FULLY_COMPLETE_SEC_FLAG string,
SAF_FILM_LEASING_FLAG string,
PRINCIPAL_AMT float,
MTM float,
AMORTISATION_AMT float,
BSD_MARKER string,
EC92_CODE string,
B2_IRB_COLLTRL_AMT_TTC float,
B2_IRB_GARNTEE_AMT_TTC float,
SEC_DISCNT_B2_IRB_COLL_AMT_TTC float,
SEC_DISCNT_B2_IRB_GTEE_AMT_TTC float,
PARENT_COUNTERPARTY_RK int,
IMMOVABLE_PROP_INDICATOR string,
SLOTTING_EFF_MATURITY_BAND_RK int,
COREP_IRB_ASSET_CLASS_RK int,
ALTERNATIVE_STD_CCF_0 float,
ALTERNATIVE_STD_CCF_20 float,
ALTERNATIVE_STD_CCF_50 float,
ALTERNATIVE_STD_CCF_100 float,
COREP_CRM_REPORTING_FLAG string,
STD_ACT_RISK_WEIGHT float,
ABCP_FLAG string,
ACCOUNTING_TREATMENT string,
AVG_RW_PCT_IAA float,
B2_IRB_SEC_CQS_INCEPTION string,
B2_IRB_SEC_STRUC_AMT float,
B2_STD_SEC_CQS_AT_INCEPTION string,
CCP_RISK_WEIGHT float,
COMPLIANCE_RETENTION string,
CONDUIT_FLAG string,
CS_PROXY_USED_FLAG string,
DIRECT_CREDIT_SUBSTITUES float,
EARLY_AMORT_CONV_FACT_APPLIED float,
EARLY_AMORTISATION_FLAG string,
EXP_VAL_DEDUCTED_FROM_OWN_FUND float,
FUNDED_CREDIT_PROTECTION float,
MEMO_ITEMS_ELIG_LQ_FACILITIES float,
MEMO_ITEMS_IRS_CRS float,
MEMO_ITEMS_OTHERS float,
MEMO_ITEMS_OWN_FUND_OUTFLOW float,
NOTIONAL_OR_REPO_AMT float,
NUMBER_OF_EXPOSURES string,
ORIGINATION_DATE string,
RETENTION_PCT float,
SECN_FRST_FORESBL_TRMNATE_DATE string,
SECN_GAAP_OTTI_AMT float,
SECN_IFRS_OTTI_AMT float,
SECN_LEGAL_FINAL_MTY_DATE string,
SECN_ORIG_COUNTERPARTY_RK int,
SECN_OTTI_CURRENCY string,
SECN_UNFUND_CRDT_PROTECT_AMT float,
SOLVENCY_TREATMENT string,
TOT_AMT_OF_SEC_EXP_ORIGINATED float,
TOT_AMT_SEC_EXP_AT_REP_DATE string,
TRADING_BOOK_CTP_OR_NON_CTP string,
TRADING_BOOK_NET_POS_LONG float,
TRADING_BOOK_NET_POS_SHORT float,
TRADING_BOOK_TOT_OWN_FUNDS float,
TYPE_OF_RETENTION_APPLIED string,
COUNTRY_UNDERLY_RISK_RK int,
FIN_COL float,
B2_IRB_INTEREST_AT_DEFAULT_GBP float,
PORTFOLIO string,
REIL_AMT_GBP float,
PROVISION_GRANULARITY string,
RECOVERIES_AMT_GBP float,
REIL_STATUS string,
PROV_MATCHED_FLAG string,
RP_TURNOVER_MAX_EUR float,
RP_TURNOVER_CCY string,
RP_SALES_TURNOVER_LOCAL float,
RP_SALES_TURNOVER_SOURCE string,
B3_SME_RP_FLAG string,
B3_SME_RP_IRB_CORP_FLAG string,
B3_SME_RP_1_5M_FLAG string,
B3_SME_DISCOUNT_FLAG string,
TOTAL_ASSET_LOCAL float,
LE_TOTAL_ASSET_AMOUNT_EUR float,
COUNTRY_OF_RESIDENCE_RK bigint,
CRD4_MEMO_ITEMS_EXPOSURE_TYPE string,
MARKET_RISK_SUB_TYPE string,
PERS_ACC_FLAG string,
LE_FI_AVC_CATEGORY string,
B2_IRB_RWA_R_COR_COEFF float,
B2_IRB_RWA_K_CAPITAL_REQ_PRE float,
B2_IRB_RWA_K_CAPITAL_REQ_POST float,
SCALE_UP_COEFENT_OF_CORELATION float,
RRU_CODE string,
B3_CVA_CC_ADV_VAR_AVG float,
B3_CVA_CC_ADV_VAR_SPOT float,
B3_CVA_CC_ADV_VAR_STRESS_AVG float,
B3_CVA_CC_ADV_VAR_STRESS_SPOT float,
B3_CVA_CC_CAPITAL_AMT float,
B3_CVA_CC_RWA_AMT float,
B3_CVA_CC_CD_SNGL_NAM_NTNL_AMT float,
B3_CVA_CC_CDS_INDEX_NTNL_AMT float,
B2_ALGO_IRB_CORP_SME_FLAG string,
INDUSTRY_RK bigint,
STATUTORY_LEDGER_BALANCE float,
CARRYING_VALUE float,
RAFA_MAPPING_RK float,
LEVERAGE_EXPOSURE float,
CCB_COUNTRY_RK bigint,
COI_COUNTRY_RULE_RK bigint,
COO_COUNTRY_RULE_RK bigint,
COR_COUNTRY_RULE_RK bigint,
CCB_COUNTRY_RULE_RK bigint,
STANDALONE_ENTITY string,
RP_TURNOVER_SOURCE_TYPE string,
P3_PD_BAND_RK bigint,
EXP_SECURED_BY_COLLATERAL_AMT float,
EXP_SEC_BY_COLL_COVERED_AMT float,
EXP_SECURED_BY_GUARANTEES_AMT float,
EXP_SEC_BY_GUAR_COVERED_AMT float,
EXP_SECURED_BY_CRD_DRVS_AMT float,
EXP_SEC_BY_CRD_DRV_COVERED_AMT float,
P3_STD_ASSET_CLASS_RK bigint,
BLANK_CRM_CATEGORY_AMT float,
EXP_UNSECURED_CARRYING_AMT float,
CRD4_MEMO_ITEMS_ASSET_CLASS_RK bigint,
INTEREST_SUSPENSE_AMT_GBP float,
TOT_REGU_PROV_AMT_GBP float,
COREP_INCORP_COUNTRY_RK bigint,
NET_MKT_VAL float,
B2_APP_CAP_REQ_POST_CRM_AMT float,
LER_CHILD_COUNTERPARTY_RK bigint,
IG_EXCLUSION_FLAG string,
NEW_IN_DEFAULT_FLAG string,
RETAIL_POOL_SME_FLAG string,
B2_IRB_CCF float,
LTV_WHOLESALE bigint,
MITIGANT_CURRENT_FAC_VAL_GBP float,
FAC_FACILITY_RK bigint,
IMPAIRMENT_LOSS_GBP float,
GRDW_POOL_ID string,
GRDW_POOL_GROUP_ID bigint,
NEW_DFL_SINCE_LAST_REP_PRD_WS string,
DEAL_TYPE string,
LGD_MODEL_RK bigint,
LGD_CALC_MODE string,
DEFINITIVE_SLOT_CATEGORY_CALC string,
REPU_COMM_MORE_THAN_YEAR_GBP float,
REPU_COMM_LESS_THAN_YEAR_GBP float,
UNCOMM_UNDRAWN_AMT_GBP float,
TOTAL_UNDRAWN_AMOUNT_GBP float,
COLLECTIVELY_EVALUATED_FLAG string,
B2_STD_CREDIT_QUALITY_STEP string,
GL_ACCOUNT_RK bigint,
DRAWN_LEDGER_BALANCE float,
E_STAR_GROSS_EXPOSURE float,
GROSS_CARRYING_VALUE float,
B2_IRB_RWA_PRE_CDS float,
RA_AD_EXP float,
EAD_MODEL_RK bigint,
ORIGINAL_CURRENCY_CODE string,
ORIGINAL_TRADE_ID string,
COMM_REAL_ESTATE_SEC_FLAG string,
SECURITISATION_DETAIL_RK bigint,
LER_CREDIT_QUALITY_STEP string,
FSA_GROSS_EXPOSURE float,
FSA045_PD_BAND_RK bigint,
RISK_TAKER_RF_FLAG string,
RISK_TAKER_GS_CODE string,
RISK_ON_RF_FLAG string,
RISK_ON_GS_CODE string,
BORROWER_GS_CODE string,
ULTIMATE_RING_FENCE_PARENT_RK bigint,
COREP_INDUSTRY_RK bigint,
SUBG_CATEGORY_RK bigint,
LE_CPTY_SUBG_CATEGORY_RK bigint,
STS_SECURITISATION string,
STS_SEC_QUAL_CAP_TRTMNT string,
STS_SEC_APPROACH_CODE string,
B3_APP_RWA_INC_CVA_CC_AMT float,
IFRS9_TOT_REGU_ECL_AMT_GBP float,
IFRS9_FINAL_ECL_MES_GBP float,
IFRS9_FINAL_STAGE string,
IFRS9_STAGE_3_TYPE string,
IFRS9_FINAL_IIS_GBP float, 
IFRS9_PROV_IMPAIRMENT_AMT_GBP float,
IFRS9_ECL_CURRENCY_CODE string,
IFRS9_PROV_WRITE_OFF_AMT_GBP float, 
IFRS9_TOT_STATUT_ECL_AMT_GBP float,
IFRS9_DISCNT_UNWIND_AMT_GBP float,
B1_EAD_POST_CRM_AMT float,
B1_RISK_WEIGHT_RATIO float,
B1_RWA_PRE_CRM_AMT float,
B1_UNDRAWN_COMMITMENT_GBP float,
B2_IRB_EFFECTIVE_MATURITY_YRS float,
B2_IRB_RWA_PRE_CRM_AMT float,
B2_STD_RWA_PRE_CRM_AMT float,
E_STAR_NET_EXPOSURE float,
FACILITY_MATCHING_LEVEL string,
PRODUCT_FAMILY_CODE bigint,
CARTHESIS_REPORTING_ID bigint,
RESIDUAL_MATURITY_BAND_RK bigint,
RISK_TYPE string,
NGAAP_PROVISION_AMT_GBP float,
REP_PROVISION_AMT_GBP float,
C33_EXPOSURE_SECTOR string,
FINREP_COUNTERPARTY_SECTOR string,
IAS39_CLASS string,
REP_PROVISION_TYPE string,
SME_DISCOUNT_FACTOR float,
B2_STD_RWA_PRE_SPRT_AMT bigint,
B2_STD_RWA_PRE_SPRT_AMT_ONBAL bigint,
B2_STD_RWA_PRE_SPRT_AMT_OFBAL bigint,
RWA_POST_CRM_PRE_SPRT_AMOUNT bigint,
B2_IRB_RWA_PRE_SPRT_AMT_ONBAL bigint,
B2_IRB_RWA_PRE_SPRT_AMT_OFBAL bigint,
CRR2_501A_DISCOUNT_FLAG string,
MORTGAGES_FLAG string,
SECURITY_RK bigint,
B2_IRB_CRM_COD_AMT float,
B2_IRB_CRM_LIP_AMT float,
CAPITAL_CUTS string,
CRR2_FLAG string,
BASEL_SECURITY_SUB_TYPE string,
SYS_PROTECTION_TYPE string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' ESCAPED BY '\\' LINES TERMINATED BY '\n'
LOCATION
  's3://bucket-eu-west-1-897144472116-processed-data/transformation/rtd/rtd_mart/raw_fct_corep_crd4/'


---------------------------------------------------------------------
main table 
---------------------------------------------------------------------


CREATE external TABLE rtd_mart.fct_corep_crd4(
DEAL_ID string,
MITIGANT_ID string,
SYS_CODE string, 
REPORTING_REGULATOR_CODE string,
WALKER_COST_CENTRE_RK int,
COUNTERPARTY_RK int,
LE_COUNTERPARTY_RK int,
WBU_COUNTERPARTY_RK int,
DIVISION_RK int,
INCORP_COUNTRY_RK int,
OP_COUNTRY_RK int,
RISK_COUNTRY_RK int,
BRANCH_COUNTRY_RK int,
B2_IRB_ASSET_CLASS_RK int,
COREP_ASSET_CLASS_RK int,
COREP_STD_ASSET_CLASS_RK int,
COREP_PRDEF_STD_ASSET_CLASS_RK int,
B2_STD_ASSET_CLASS_RK int,
PRODUCT_RK int,
COREP_PRODUCT_CATEGORY_RK int,
PD_MODEL_RK int,
COUNTERPARTY_MGS_PD_BAND_RK int,
CBI_PD_BAND_CODE_RK int,
MGS_PD_BAND_CODE_RK int,
RET_PD_BAND_CODE_RK int,
RRU_RK int,
RISK_ON_RRU_RK int,
UNSETTLED_PERIOD_CODE int,
UNSETTLED_FACTOR_CODE int,
RUN_RK int,
ACCRUED_INT_ONBAL_AMT float,
ACCRUED_INTEREST_GBP float,
ACLM_PRODUCT_TYPE string,
ADJUST_FLAG string,
REPORTING_TYPE_CODE string,
RWA_APPROACH_CODE string,
B1_RWA_POST_CRM_AMT float,
B2_APP_ADJUSTED_LGD_RATIO float,
B2_APP_ADJUSTED_PD_RATIO float,
B2_APP_EXPECTED_LOSS_AMT float,
B2_APP_RISK_WEIGHT_RATIO float,
B2_IRB_CRM_FCP_ELG_FIN_COL_AMT float,
B2_IRB_CRM_FCP_OTH_PHY_COL_AMT float,
B2_IRB_CRM_FCP_OTH_FUNDED_AMT float,
B2_IRB_CRM_FCP_REAL_ESTATE_AMT float,
B2_IRB_CRM_FCP_RECEIVABLES_AMT float,
B2_IRB_CRM_UFCP_CRED_DERIV_AMT float,
B2_IRB_CRM_UFCP_DOUBLE_DEF_AMT float,
B2_IRB_CRM_UFCP_GUAR_AMT float,
B2_IRB_DEFAULT_DATE date,
B2_IRB_DRAWN_EAD float,
B2_IRB_DRAWN_EXPECTED_LOSS float,
B2_IRB_DRAWN_RWA float,
B2_IRB_EAD_AMT_OFBAL float,
B2_IRB_EAD_AMT_ONBAL float,
B2_IRB_EL_AMT_OFBAL float,
B2_IRB_EL_AMT_ONBAL float,
B2_IRB_NETTED_COLL_GBP float,
B2_IRB_OBSRVD_NEW_DEFAULT_FLAG string,
B2_STD_OBSRVD_NEW_DEFAULT_FLAG string,
B2_IRB_ORIG_EXP_PRE_CON_FACTOR float,
B2_IRB_PROVISIONS_AMT float,
B2_IRB_RWA_AMT_OFBAL float,
B2_IRB_RWA_AMT_ONBAL float,
B2_IRB_UNDRAWN_EAD float,
B2_IRB_UNDRAWN_EXPECTED_LOSS float,
B2_IRB_UNDRAWN_RWA float,
B2_STD_CCF float,
B2_STD_CCF_LESS_THAN_YEAR float,
B2_STD_CCF_MORE_THAN_YEAR float,
B2_STD_COLL_FX_HAIRCUT_AMT float,
B2_STD_COLL_VOLATILITY_AMT float,
B2_STD_CRM_TOT_INFLOW float,
B2_STD_CRM_TOT_INFLOW_OFBAL float,
B2_STD_CRM_TOT_INFLOW_ONBAL float,
B2_STD_CRM_TOT_INFLOW_RWA float,
B2_STD_CRM_TOT_OUTFLOW float,
B2_STD_CRM_TOT_OUTFLOW_OFBAL float,
B2_STD_CRM_TOT_OUTFLOW_ONBAL float,
B2_STD_CRM_TOT_OUTFLOW_RWA float,
B2_STD_DEFAULT_DATE date,
B2_STD_DRAWN_EAD float,
B2_STD_DRAWN_RWA float,
B2_STD_EAD_POST_CRM_AMT_OFBAL float,
B2_STD_EAD_POST_CRM_AMT_ONBAL float,
B2_STD_EFF_CDS_AMT float,
B2_STD_EFF_FIN_COLL_AMT float,
B2_STD_EFF_GTEE_AMT float,
B2_STD_COLL_MTY_MISMATCH_AMT float,
B2_STD_EXP_HAIRCUT_ADJ_AMT float,
B2_STD_EXPOSURE_VALUE float,
B2_STD_EXPOSURE_VALUE_OFBAL float,
B2_STD_EXPOSURE_VALUE_ONBAL float,
B2_STD_FULLY_ADJ_EXP float,
B2_STD_FULLY_ADJ_EXP_CCF_0 float,
B2_STD_FULLY_ADJ_EXP_CCF_100 float,
B2_STD_FULLY_ADJ_EXP_CCF_20 float,
B2_STD_FULLY_ADJ_EXP_CCF_50 float,
B2_STD_FULLY_ADJ_EXP_OFBAL float,
B2_STD_FULLY_ADJ_EXP_ONBAL float,
B2_STD_NET_EXP_POST_CRM_SUBST float,
STD_NET_EXP_POSTCRM_SUBT_OFBAL float,
STD_NET_EXP_POSTCRM_SUBT_ONBAL float,
B2_STD_NET_EXP_PRE_CRM_SUBST float,
STD_NET_EXP_PRECRM_SUBST_OFBAL float,
STD_NET_EXP_PRECRM_SUBST_ONBAL float,
B2_STD_NETTED_COLL_GBP float,
B2_STD_ORIG_EXP_PRE_CON_FACTOR float,
B2_STD_OTH_FUN_CRED_PROT_AMT float,
B2_STD_PROVISIONS_AMT float,
B2_STD_PROVISIONS_AMT_OFBAL float,
B2_STD_PROVISIONS_AMT_ONBAL float,
B2_STD_RISK_WEIGHT_INDICATOR string,
B2_STD_RISK_WEIGHT_RATIO float,
B2_STD_RWA_AMT float,
B2_STD_RWA_AMT_OFBAL float,
B2_STD_RWA_AMT_ONBAL float,
B2_STD_RWA_POST_CRM_AMT_OFBAL float,
B2_STD_RWA_POST_CRM_AMT_ONBAL float,
B2_STD_UNDRAWN_EAD float,
B2_STD_UNDRAWN_RWA float,
B3_CCP_MARGIN_INITL_CASH_AMT float,
B3_CCP_MARGIN_INITL_NOCASH_AMT float,
B3_CCP_MARGIN_INITL_RWA_AMT float,
B3_CCP_MARGIN_NONINITL_RWA_AMT float,
B3_CVA_CC_ADV_FLAG string,
B3_CVA_PROVISION_AMT float,
B3_CVA_PROVISION_RESIDUAL_AMT float,
BASEL_DATA_FLAG string,
COLL_GOOD_PROV_AMT float,
COMM_LESS_THAN_1_YEAR float,
COMM_LESS_THAN_1_YR_APPORTION float,
COMM_MORE_THAN_1_YEAR float,
COMM_MORE_THAN_1_YR_APPORTION float,
CRD4_REP_CVA_FLAG string,
CRD4_REP_IRB_FLAG string,
CRD4_REP_IRBEQ_FLAG string,
CRD4_REP_SETTL_FLAG string,
CRD4_REP_STD_FLAG string,
CRD4_REP_STDFLOW_FLAG string,
CVA_CHARGE float,
DEFAULT_FUND_CONTRIB_INDICATOR string,
DOUBLE_DEFAULT_FLAG string,
EAD_LGD_NUMERATOR float,
EAD_LGD_NUMERATOR_OFF float,
EAD_LGD_NUMERATOR_ON float,
EAD_MAT_YEARS_NUMERATOR float,
EAD_MAT_YEARS_NUMERATOR_OFF float,
EAD_MAT_YEARS_NUMERATOR_ON float,
EAD_PD_NUMERATOR float,
EAD_PD_NUMERATOR_OFF float,
EAD_PD_NUMERATOR_ON float,
EAD_POST_CRM_AMT float,
EAD_PRE_CRM_AMT float,
EXCH_RATE_EUR float,
EXCH_RATE_USD float,
FLOW_TYPE string,
GROSS_DEP_UTILISATION_AMT float,
IMP_IMPAIRMENT_AMT float,
IMP_WRITE_OFF_AMT float,
INTERNAL_TRANSACTION_FLAG string,
IRB_ORIG_EXP_PRE_CONV_OFBAL float,
IRB_ORIG_EXP_PRE_CONV_ONBAL float,
IRB_RISK_WEIGHT_RATIO float,
LRFE_UFE_FLAG string,
NET_DEP_UTILISATION_AMT float,
NET_EXPOSURE float,
NET_EXPOSURE_POST_SEC float,
OBLIGOR_TYPE string,
OFF_BAL_LED_EXP_GBP_POST_SEC float,
OFF_BALANCE_EXPOSURE float,
ON_BAL_LED_EXP_GBP_POST_SEC float,
ON_BALANCE_LEDGER_EXPOSURE float,
PAST_DUE_ASSET_FLAG string,
PROVISION_AMOUNT_GBP float,
QCCP_FLAG string,
RESIDUAL_MATURITY_DAYS float,
RESIDUAL_VALUE float,
RETAIL_OFF_BAL_SHEET_FLAG string,
RISK_ON_GROUP_STRUCTURE string,
RISK_TAKER_GROUP_STRUCTURE string,
RWA_CALC_METHOD string,
RWA_POST_CRM_AMOUNT float,
SECURITISED_FLAG string,
SET_OFF_INDICATOR string,
SLOTTING_RESIDUAL_MATURITY string,
SME_FLAG string,
SRT_FLAG string,
STD_ORIG_EXP_PRE_CONV_OFBAL float,
STD_ORIG_EXP_PRE_CONV_ONBAL float,
STD_RISK_WEIGHT_RATIO float,
TRADING_BOOK_FLAG string,
UNDRAWN_COMMITMENT_AMT float,
UNDRAWN_COMMITMENT_AMT_PST_SEC float,
UNSETTLED_AMOUNT float,
UNSETTLED_PRICE_DIFFERENCE_AMT float,
LEASE_EXPOSURE_GBP float,
LEASE_PAYMENT_VALUE_AMT float,
RETAIL_OBLIGOR_COUNT int,
STD_EXPOSURE_DEFAULT_FLAG string, 
STD_EXP_TYPE_PRI_ORDER_RULE_RK int,
CRD4_SOV_SUBSTITUTION_FLAG string,
STD_RW_PRIORITY_ORDER_RULE_RK int,
UNLIKELY_PAY_FLAG string,
CRD4_STD_RP_SME_FLAG string,
CRD4_IRB_RP_SME_FLAG string,
STD_SME_DISCOUNT_APP_FLAG string,
IRB_SME_DISCOUNT_APP_FLAG string,
TRANSITIONAL_PORTFOLIO_FLAG string,
FULLY_COMPLETE_SEC_FLAG string,
SAF_FILM_LEASING_FLAG string,
PRINCIPAL_AMT float,
MTM float,
AMORTISATION_AMT float,
BSD_MARKER string,
EC92_CODE string,
B2_IRB_COLLTRL_AMT_TTC float,
B2_IRB_GARNTEE_AMT_TTC float,
SEC_DISCNT_B2_IRB_COLL_AMT_TTC float,
SEC_DISCNT_B2_IRB_GTEE_AMT_TTC float,
PARENT_COUNTERPARTY_RK int,
IMMOVABLE_PROP_INDICATOR string,
SLOTTING_EFF_MATURITY_BAND_RK int,
COREP_IRB_ASSET_CLASS_RK int,
ALTERNATIVE_STD_CCF_0 float,
ALTERNATIVE_STD_CCF_20 float,
ALTERNATIVE_STD_CCF_50 float,
ALTERNATIVE_STD_CCF_100 float,
COREP_CRM_REPORTING_FLAG string,
STD_ACT_RISK_WEIGHT float,
ABCP_FLAG string,
ACCOUNTING_TREATMENT string,
AVG_RW_PCT_IAA float,
B2_IRB_SEC_CQS_INCEPTION string,
B2_IRB_SEC_STRUC_AMT float,
B2_STD_SEC_CQS_AT_INCEPTION string,
CCP_RISK_WEIGHT float,
COMPLIANCE_RETENTION string,
CONDUIT_FLAG string,
CS_PROXY_USED_FLAG string,
DIRECT_CREDIT_SUBSTITUES float,
EARLY_AMORT_CONV_FACT_APPLIED float,
EARLY_AMORTISATION_FLAG string,
EXP_VAL_DEDUCTED_FROM_OWN_FUND float,
FUNDED_CREDIT_PROTECTION float,
MEMO_ITEMS_ELIG_LQ_FACILITIES float,
MEMO_ITEMS_IRS_CRS float,
MEMO_ITEMS_OTHERS float,
MEMO_ITEMS_OWN_FUND_OUTFLOW float,
NOTIONAL_OR_REPO_AMT float,
NUMBER_OF_EXPOSURES string,
ORIGINATION_DATE date,
RETENTION_PCT float,
SECN_FRST_FORESBL_TRMNATE_DATE date,
SECN_GAAP_OTTI_AMT float,
SECN_IFRS_OTTI_AMT float,
SECN_LEGAL_FINAL_MTY_DATE date,
SECN_ORIG_COUNTERPARTY_RK int,
SECN_OTTI_CURRENCY string,
SECN_UNFUND_CRDT_PROTECT_AMT float,
SOLVENCY_TREATMENT string,
TOT_AMT_OF_SEC_EXP_ORIGINATED float,
TOT_AMT_SEC_EXP_AT_REP_DATE date,
TRADING_BOOK_CTP_OR_NON_CTP string,
TRADING_BOOK_NET_POS_LONG float,
TRADING_BOOK_NET_POS_SHORT float,
TRADING_BOOK_TOT_OWN_FUNDS float,
TYPE_OF_RETENTION_APPLIED string,
COUNTRY_UNDERLY_RISK_RK int,
FIN_COL float,
B2_IRB_INTEREST_AT_DEFAULT_GBP float,
PORTFOLIO string,
REIL_AMT_GBP float,
PROVISION_GRANULARITY string,
RECOVERIES_AMT_GBP float,
REIL_STATUS string,
PROV_MATCHED_FLAG string,
RP_TURNOVER_MAX_EUR float,
RP_TURNOVER_CCY string,
RP_SALES_TURNOVER_LOCAL float,
RP_SALES_TURNOVER_SOURCE string,
B3_SME_RP_FLAG string,
B3_SME_RP_IRB_CORP_FLAG string,
B3_SME_RP_1_5M_FLAG string,
B3_SME_DISCOUNT_FLAG string,
TOTAL_ASSET_LOCAL float,
LE_TOTAL_ASSET_AMOUNT_EUR float,
COUNTRY_OF_RESIDENCE_RK bigint,
CRD4_MEMO_ITEMS_EXPOSURE_TYPE string,
MARKET_RISK_SUB_TYPE string,
PERS_ACC_FLAG string,
LE_FI_AVC_CATEGORY string,
B2_IRB_RWA_R_COR_COEFF float,
B2_IRB_RWA_K_CAPITAL_REQ_PRE float,
B2_IRB_RWA_K_CAPITAL_REQ_POST float,
SCALE_UP_COEFENT_OF_CORELATION float,
RRU_CODE string,
B3_CVA_CC_ADV_VAR_AVG float,
B3_CVA_CC_ADV_VAR_SPOT float,
B3_CVA_CC_ADV_VAR_STRESS_AVG float,
B3_CVA_CC_ADV_VAR_STRESS_SPOT float,
B3_CVA_CC_CAPITAL_AMT float,
B3_CVA_CC_RWA_AMT float,
B3_CVA_CC_CD_SNGL_NAM_NTNL_AMT float,
B3_CVA_CC_CDS_INDEX_NTNL_AMT float,
B2_ALGO_IRB_CORP_SME_FLAG string,
INDUSTRY_RK bigint,
STATUTORY_LEDGER_BALANCE float,
CARRYING_VALUE float,
RAFA_MAPPING_RK float,
LEVERAGE_EXPOSURE float,
CCB_COUNTRY_RK bigint,
COI_COUNTRY_RULE_RK bigint,
COO_COUNTRY_RULE_RK bigint,
COR_COUNTRY_RULE_RK bigint,
CCB_COUNTRY_RULE_RK bigint,
STANDALONE_ENTITY string,
RP_TURNOVER_SOURCE_TYPE string,
P3_PD_BAND_RK bigint,
EXP_SECURED_BY_COLLATERAL_AMT float,
EXP_SEC_BY_COLL_COVERED_AMT float,
EXP_SECURED_BY_GUARANTEES_AMT float,
EXP_SEC_BY_GUAR_COVERED_AMT float,
EXP_SECURED_BY_CRD_DRVS_AMT float,
EXP_SEC_BY_CRD_DRV_COVERED_AMT float,
P3_STD_ASSET_CLASS_RK bigint,
BLANK_CRM_CATEGORY_AMT float,
EXP_UNSECURED_CARRYING_AMT float,
CRD4_MEMO_ITEMS_ASSET_CLASS_RK bigint,
INTEREST_SUSPENSE_AMT_GBP float,
TOT_REGU_PROV_AMT_GBP float,
COREP_INCORP_COUNTRY_RK bigint,
NET_MKT_VAL float,
B2_APP_CAP_REQ_POST_CRM_AMT float,
LER_CHILD_COUNTERPARTY_RK bigint,
IG_EXCLUSION_FLAG string,
NEW_IN_DEFAULT_FLAG string,
RETAIL_POOL_SME_FLAG string,
B2_IRB_CCF float,
LTV_WHOLESALE bigint,
MITIGANT_CURRENT_FAC_VAL_GBP float,
FAC_FACILITY_RK bigint,
IMPAIRMENT_LOSS_GBP float,
GRDW_POOL_ID string,
GRDW_POOL_GROUP_ID bigint,
NEW_DFL_SINCE_LAST_REP_PRD_WS string,
DEAL_TYPE string,
LGD_MODEL_RK bigint,
LGD_CALC_MODE string,
DEFINITIVE_SLOT_CATEGORY_CALC string,
REPU_COMM_MORE_THAN_YEAR_GBP float,
REPU_COMM_LESS_THAN_YEAR_GBP float,
UNCOMM_UNDRAWN_AMT_GBP float,
TOTAL_UNDRAWN_AMOUNT_GBP float,
COLLECTIVELY_EVALUATED_FLAG string,
B2_STD_CREDIT_QUALITY_STEP string,
GL_ACCOUNT_RK bigint,
DRAWN_LEDGER_BALANCE float,
E_STAR_GROSS_EXPOSURE float,
GROSS_CARRYING_VALUE float,
B2_IRB_RWA_PRE_CDS float,
RA_AD_EXP float,
EAD_MODEL_RK bigint,
ORIGINAL_CURRENCY_CODE string,
ORIGINAL_TRADE_ID string,
COMM_REAL_ESTATE_SEC_FLAG string,
SECURITISATION_DETAIL_RK bigint,
LER_CREDIT_QUALITY_STEP string,
FSA_GROSS_EXPOSURE float,
FSA045_PD_BAND_RK bigint,
RISK_TAKER_RF_FLAG string,
RISK_TAKER_GS_CODE string,
RISK_ON_RF_FLAG string,
RISK_ON_GS_CODE string,
BORROWER_GS_CODE string,
ULTIMATE_RING_FENCE_PARENT_RK bigint,
COREP_INDUSTRY_RK bigint,
SUBG_CATEGORY_RK bigint,
LE_CPTY_SUBG_CATEGORY_RK bigint,
STS_SECURITISATION string,
STS_SEC_QUAL_CAP_TRTMNT string,
STS_SEC_APPROACH_CODE string,
B3_APP_RWA_INC_CVA_CC_AMT float,
IFRS9_TOT_REGU_ECL_AMT_GBP float,
IFRS9_FINAL_ECL_MES_GBP float,
IFRS9_FINAL_STAGE string,
IFRS9_STAGE_3_TYPE string,
IFRS9_FINAL_IIS_GBP float, 
IFRS9_PROV_IMPAIRMENT_AMT_GBP float,
IFRS9_ECL_CURRENCY_CODE string,
IFRS9_PROV_WRITE_OFF_AMT_GBP float, 
IFRS9_TOT_STATUT_ECL_AMT_GBP float,
IFRS9_DISCNT_UNWIND_AMT_GBP float,
B1_EAD_POST_CRM_AMT float,
B1_RISK_WEIGHT_RATIO float,
B1_RWA_PRE_CRM_AMT float,
B1_UNDRAWN_COMMITMENT_GBP float,
B2_IRB_EFFECTIVE_MATURITY_YRS float,
B2_IRB_RWA_PRE_CRM_AMT float,
B2_STD_RWA_PRE_CRM_AMT float,
E_STAR_NET_EXPOSURE float,
FACILITY_MATCHING_LEVEL string,
PRODUCT_FAMILY_CODE bigint,
CARTHESIS_REPORTING_ID bigint,
RESIDUAL_MATURITY_BAND_RK bigint,
RISK_TYPE string,
NGAAP_PROVISION_AMT_GBP float,
REP_PROVISION_AMT_GBP float,
C33_EXPOSURE_SECTOR string,
FINREP_COUNTERPARTY_SECTOR string,
IAS39_CLASS string,
REP_PROVISION_TYPE string,
SME_DISCOUNT_FACTOR float,
B2_STD_RWA_PRE_SPRT_AMT bigint,
B2_STD_RWA_PRE_SPRT_AMT_ONBAL bigint,
B2_STD_RWA_PRE_SPRT_AMT_OFBAL bigint,
RWA_POST_CRM_PRE_SPRT_AMOUNT bigint,
B2_IRB_RWA_PRE_SPRT_AMT_ONBAL bigint,
B2_IRB_RWA_PRE_SPRT_AMT_OFBAL bigint,
CRR2_501A_DISCOUNT_FLAG string,
MORTGAGES_FLAG string,
SECURITY_RK bigint,
B2_IRB_CRM_COD_AMT float,
B2_IRB_CRM_LIP_AMT float,
CAPITAL_CUTS string,
CRR2_FLAG string,
BASEL_SECURITY_SUB_TYPE string,
SYS_PROTECTION_TYPE string)
partitioned by(YEAR_MONTH_RK int)
STORED AS parquet
LOCATION
  's3://bucket-eu-west-1-897144472116-processed-data/transformation/rtd/rtd_mart/fct_corep_crd4/'



------------------------------------------------------------------------
Dynamic partition creation

set hive.exec.dynamic.partition.mode=nonstrict;

insert into rtd_mart.fct_corep_crd4 partition(YEAR_MONTH_RK) select 
DEAL_ID ,
MITIGANT_ID ,
SYS_CODE , 
REPORTING_REGULATOR_CODE ,
WALKER_COST_CENTRE_RK ,
COUNTERPARTY_RK ,
LE_COUNTERPARTY_RK ,
WBU_COUNTERPARTY_RK ,
DIVISION_RK ,
INCORP_COUNTRY_RK ,
OP_COUNTRY_RK ,
RISK_COUNTRY_RK ,
BRANCH_COUNTRY_RK ,
B2_IRB_ASSET_CLASS_RK ,
COREP_ASSET_CLASS_RK ,
COREP_STD_ASSET_CLASS_RK ,
COREP_PRDEF_STD_ASSET_CLASS_RK ,
B2_STD_ASSET_CLASS_RK ,
PRODUCT_RK ,
COREP_PRODUCT_CATEGORY_RK ,
PD_MODEL_RK ,
COUNTERPARTY_MGS_PD_BAND_RK ,
CBI_PD_BAND_CODE_RK ,
MGS_PD_BAND_CODE_RK ,
RET_PD_BAND_CODE_RK ,
RRU_RK ,
RISK_ON_RRU_RK ,
UNSETTLED_PERIOD_CODE ,
UNSETTLED_FACTOR_CODE ,
RUN_RK ,
ACCRUED_INT_ONBAL_AMT ,
ACCRUED_INTEREST_GBP ,
ACLM_PRODUCT_TYPE ,
ADJUST_FLAG ,
REPORTING_TYPE_CODE ,
RWA_APPROACH_CODE ,
B1_RWA_POST_CRM_AMT ,
B2_APP_ADJUSTED_LGD_RATIO ,
B2_APP_ADJUSTED_PD_RATIO ,
B2_APP_EXPECTED_LOSS_AMT ,
B2_APP_RISK_WEIGHT_RATIO ,
B2_IRB_CRM_FCP_ELG_FIN_COL_AMT ,
B2_IRB_CRM_FCP_OTH_PHY_COL_AMT ,
B2_IRB_CRM_FCP_OTH_FUNDED_AMT ,
B2_IRB_CRM_FCP_REAL_ESTATE_AMT ,
B2_IRB_CRM_FCP_RECEIVABLES_AMT ,
B2_IRB_CRM_UFCP_CRED_DERIV_AMT ,
B2_IRB_CRM_UFCP_DOUBLE_DEF_AMT ,
B2_IRB_CRM_UFCP_GUAR_AMT ,
to_date(from_unixtime(unix_timestamp(B2_IRB_DEFAULT_DATE,'MM/dd/yyyy'))) as B2_IRB_DEFAULT_DATE,
B2_IRB_DRAWN_EAD ,
B2_IRB_DRAWN_EXPECTED_LOSS ,
B2_IRB_DRAWN_RWA ,
B2_IRB_EAD_AMT_OFBAL ,
B2_IRB_EAD_AMT_ONBAL ,
B2_IRB_EL_AMT_OFBAL ,
B2_IRB_EL_AMT_ONBAL ,
B2_IRB_NETTED_COLL_GBP ,
B2_IRB_OBSRVD_NEW_DEFAULT_FLAG ,
B2_STD_OBSRVD_NEW_DEFAULT_FLAG ,
B2_IRB_ORIG_EXP_PRE_CON_FACTOR ,
B2_IRB_PROVISIONS_AMT ,
B2_IRB_RWA_AMT_OFBAL ,
B2_IRB_RWA_AMT_ONBAL ,
B2_IRB_UNDRAWN_EAD ,
B2_IRB_UNDRAWN_EXPECTED_LOSS ,
B2_IRB_UNDRAWN_RWA ,
B2_STD_CCF ,
B2_STD_CCF_LESS_THAN_YEAR ,
B2_STD_CCF_MORE_THAN_YEAR ,
B2_STD_COLL_FX_HAIRCUT_AMT ,
B2_STD_COLL_VOLATILITY_AMT ,
B2_STD_CRM_TOT_INFLOW ,
B2_STD_CRM_TOT_INFLOW_OFBAL ,
B2_STD_CRM_TOT_INFLOW_ONBAL ,
B2_STD_CRM_TOT_INFLOW_RWA ,
B2_STD_CRM_TOT_OUTFLOW ,
B2_STD_CRM_TOT_OUTFLOW_OFBAL ,
B2_STD_CRM_TOT_OUTFLOW_ONBAL ,
B2_STD_CRM_TOT_OUTFLOW_RWA ,
to_date(from_unixtime(unix_timestamp(B2_STD_DEFAULT_DATE,'MM/dd/yyyy'))) as B2_STD_DEFAULT_DATE,
B2_STD_DRAWN_EAD ,
B2_STD_DRAWN_RWA ,
B2_STD_EAD_POST_CRM_AMT_OFBAL ,
B2_STD_EAD_POST_CRM_AMT_ONBAL ,
B2_STD_EFF_CDS_AMT ,
B2_STD_EFF_FIN_COLL_AMT ,
B2_STD_EFF_GTEE_AMT ,
B2_STD_COLL_MTY_MISMATCH_AMT ,
B2_STD_EXP_HAIRCUT_ADJ_AMT ,
B2_STD_EXPOSURE_VALUE ,
B2_STD_EXPOSURE_VALUE_OFBAL ,
B2_STD_EXPOSURE_VALUE_ONBAL ,
B2_STD_FULLY_ADJ_EXP ,
B2_STD_FULLY_ADJ_EXP_CCF_0 ,
B2_STD_FULLY_ADJ_EXP_CCF_100 ,
B2_STD_FULLY_ADJ_EXP_CCF_20 ,
B2_STD_FULLY_ADJ_EXP_CCF_50 ,
B2_STD_FULLY_ADJ_EXP_OFBAL ,
B2_STD_FULLY_ADJ_EXP_ONBAL ,
B2_STD_NET_EXP_POST_CRM_SUBST ,
STD_NET_EXP_POSTCRM_SUBT_OFBAL ,
STD_NET_EXP_POSTCRM_SUBT_ONBAL ,
B2_STD_NET_EXP_PRE_CRM_SUBST ,
STD_NET_EXP_PRECRM_SUBST_OFBAL ,
STD_NET_EXP_PRECRM_SUBST_ONBAL ,
B2_STD_NETTED_COLL_GBP ,
B2_STD_ORIG_EXP_PRE_CON_FACTOR ,
B2_STD_OTH_FUN_CRED_PROT_AMT ,
B2_STD_PROVISIONS_AMT ,
B2_STD_PROVISIONS_AMT_OFBAL ,
B2_STD_PROVISIONS_AMT_ONBAL ,
B2_STD_RISK_WEIGHT_INDICATOR ,
B2_STD_RISK_WEIGHT_RATIO ,
B2_STD_RWA_AMT ,
B2_STD_RWA_AMT_OFBAL ,
B2_STD_RWA_AMT_ONBAL ,
B2_STD_RWA_POST_CRM_AMT_OFBAL ,
B2_STD_RWA_POST_CRM_AMT_ONBAL ,
B2_STD_UNDRAWN_EAD ,
B2_STD_UNDRAWN_RWA ,
B3_CCP_MARGIN_INITL_CASH_AMT ,
B3_CCP_MARGIN_INITL_NOCASH_AMT ,
B3_CCP_MARGIN_INITL_RWA_AMT ,
B3_CCP_MARGIN_NONINITL_RWA_AMT ,
B3_CVA_CC_ADV_FLAG ,
B3_CVA_PROVISION_AMT ,
B3_CVA_PROVISION_RESIDUAL_AMT ,
BASEL_DATA_FLAG ,
COLL_GOOD_PROV_AMT ,
COMM_LESS_THAN_1_YEAR ,
COMM_LESS_THAN_1_YR_APPORTION ,
COMM_MORE_THAN_1_YEAR ,
COMM_MORE_THAN_1_YR_APPORTION ,
CRD4_REP_CVA_FLAG ,
CRD4_REP_IRB_FLAG ,
CRD4_REP_IRBEQ_FLAG ,
CRD4_REP_SETTL_FLAG ,
CRD4_REP_STD_FLAG ,
CRD4_REP_STDFLOW_FLAG ,
CVA_CHARGE ,
DEFAULT_FUND_CONTRIB_INDICATOR ,
DOUBLE_DEFAULT_FLAG ,
EAD_LGD_NUMERATOR ,
EAD_LGD_NUMERATOR_OFF ,
EAD_LGD_NUMERATOR_ON ,
EAD_MAT_YEARS_NUMERATOR ,
EAD_MAT_YEARS_NUMERATOR_OFF ,
EAD_MAT_YEARS_NUMERATOR_ON ,
EAD_PD_NUMERATOR ,
EAD_PD_NUMERATOR_OFF ,
EAD_PD_NUMERATOR_ON ,
EAD_POST_CRM_AMT ,
EAD_PRE_CRM_AMT ,
EXCH_RATE_EUR ,
EXCH_RATE_USD ,
FLOW_TYPE ,
GROSS_DEP_UTILISATION_AMT ,
IMP_IMPAIRMENT_AMT ,
IMP_WRITE_OFF_AMT ,
INTERNAL_TRANSACTION_FLAG ,
IRB_ORIG_EXP_PRE_CONV_OFBAL ,
IRB_ORIG_EXP_PRE_CONV_ONBAL ,
IRB_RISK_WEIGHT_RATIO ,
LRFE_UFE_FLAG ,
NET_DEP_UTILISATION_AMT ,
NET_EXPOSURE ,
NET_EXPOSURE_POST_SEC ,
OBLIGOR_TYPE ,
OFF_BAL_LED_EXP_GBP_POST_SEC ,
OFF_BALANCE_EXPOSURE ,
ON_BAL_LED_EXP_GBP_POST_SEC ,
ON_BALANCE_LEDGER_EXPOSURE ,
PAST_DUE_ASSET_FLAG ,
PROVISION_AMOUNT_GBP ,
QCCP_FLAG ,
RESIDUAL_MATURITY_DAYS ,
RESIDUAL_VALUE ,
RETAIL_OFF_BAL_SHEET_FLAG ,
RISK_ON_GROUP_STRUCTURE ,
RISK_TAKER_GROUP_STRUCTURE ,
RWA_CALC_METHOD ,
RWA_POST_CRM_AMOUNT ,
SECURITISED_FLAG ,
SET_OFF_INDICATOR ,
SLOTTING_RESIDUAL_MATURITY ,
SME_FLAG ,
SRT_FLAG ,
STD_ORIG_EXP_PRE_CONV_OFBAL ,
STD_ORIG_EXP_PRE_CONV_ONBAL ,
STD_RISK_WEIGHT_RATIO ,
TRADING_BOOK_FLAG ,
UNDRAWN_COMMITMENT_AMT ,
UNDRAWN_COMMITMENT_AMT_PST_SEC ,
UNSETTLED_AMOUNT ,
UNSETTLED_PRICE_DIFFERENCE_AMT ,
LEASE_EXPOSURE_GBP ,
LEASE_PAYMENT_VALUE_AMT ,
RETAIL_OBLIGOR_COUNT ,
STD_EXPOSURE_DEFAULT_FLAG , 
STD_EXP_TYPE_PRI_ORDER_RULE_RK ,
CRD4_SOV_SUBSTITUTION_FLAG ,
STD_RW_PRIORITY_ORDER_RULE_RK ,
UNLIKELY_PAY_FLAG ,
CRD4_STD_RP_SME_FLAG ,
CRD4_IRB_RP_SME_FLAG ,
STD_SME_DISCOUNT_APP_FLAG ,
IRB_SME_DISCOUNT_APP_FLAG ,
TRANSITIONAL_PORTFOLIO_FLAG ,
FULLY_COMPLETE_SEC_FLAG ,
SAF_FILM_LEASING_FLAG ,
PRINCIPAL_AMT ,
MTM ,
AMORTISATION_AMT ,
BSD_MARKER ,
EC92_CODE ,
B2_IRB_COLLTRL_AMT_TTC ,
B2_IRB_GARNTEE_AMT_TTC ,
SEC_DISCNT_B2_IRB_COLL_AMT_TTC ,
SEC_DISCNT_B2_IRB_GTEE_AMT_TTC ,
PARENT_COUNTERPARTY_RK ,
IMMOVABLE_PROP_INDICATOR ,
SLOTTING_EFF_MATURITY_BAND_RK ,
COREP_IRB_ASSET_CLASS_RK ,
ALTERNATIVE_STD_CCF_0 ,
ALTERNATIVE_STD_CCF_20 ,
ALTERNATIVE_STD_CCF_50 ,
ALTERNATIVE_STD_CCF_100 ,
COREP_CRM_REPORTING_FLAG ,
STD_ACT_RISK_WEIGHT ,
ABCP_FLAG ,
ACCOUNTING_TREATMENT ,
AVG_RW_PCT_IAA ,
B2_IRB_SEC_CQS_INCEPTION ,
B2_IRB_SEC_STRUC_AMT ,
B2_STD_SEC_CQS_AT_INCEPTION ,
CCP_RISK_WEIGHT ,
COMPLIANCE_RETENTION ,
CONDUIT_FLAG ,
CS_PROXY_USED_FLAG ,
DIRECT_CREDIT_SUBSTITUES ,
EARLY_AMORT_CONV_FACT_APPLIED ,
EARLY_AMORTISATION_FLAG ,
EXP_VAL_DEDUCTED_FROM_OWN_FUND ,
FUNDED_CREDIT_PROTECTION ,
MEMO_ITEMS_ELIG_LQ_FACILITIES ,
MEMO_ITEMS_IRS_CRS ,
MEMO_ITEMS_OTHERS ,
MEMO_ITEMS_OWN_FUND_OUTFLOW ,
NOTIONAL_OR_REPO_AMT ,
NUMBER_OF_EXPOSURES ,
to_date(from_unixtime(unix_timestamp(ORIGINATION_DATE,'MM/dd/yyyy'))) as ORIGINATION_DATE,
RETENTION_PCT ,
to_date(from_unixtime(unix_timestamp(SECN_FRST_FORESBL_TRMNATE_DATE,'MM/dd/yyyy'))) as SECN_FRST_FORESBL_TRMNATE_DATE,
SECN_GAAP_OTTI_AMT ,
SECN_IFRS_OTTI_AMT ,
to_date(from_unixtime(unix_timestamp(SECN_LEGAL_FINAL_MTY_DATE,'MM/dd/yyyy'))) as SECN_LEGAL_FINAL_MTY_DATE,
SECN_ORIG_COUNTERPARTY_RK ,
SECN_OTTI_CURRENCY ,
SECN_UNFUND_CRDT_PROTECT_AMT ,
SOLVENCY_TREATMENT ,
TOT_AMT_OF_SEC_EXP_ORIGINATED ,
to_date(from_unixtime(unix_timestamp(TOT_AMT_SEC_EXP_AT_REP_DATE,'MM/dd/yyyy'))) as TOT_AMT_SEC_EXP_AT_REP_DATE, 
TRADING_BOOK_CTP_OR_NON_CTP ,
TRADING_BOOK_NET_POS_LONG ,
TRADING_BOOK_NET_POS_SHORT ,
TRADING_BOOK_TOT_OWN_FUNDS ,
TYPE_OF_RETENTION_APPLIED ,
COUNTRY_UNDERLY_RISK_RK ,
FIN_COL ,
B2_IRB_INTEREST_AT_DEFAULT_GBP ,
PORTFOLIO ,
REIL_AMT_GBP ,
PROVISION_GRANULARITY ,
RECOVERIES_AMT_GBP ,
REIL_STATUS ,
PROV_MATCHED_FLAG ,
RP_TURNOVER_MAX_EUR ,
RP_TURNOVER_CCY ,
RP_SALES_TURNOVER_LOCAL ,
RP_SALES_TURNOVER_SOURCE ,
B3_SME_RP_FLAG ,
B3_SME_RP_IRB_CORP_FLAG ,
B3_SME_RP_1_5M_FLAG ,
B3_SME_DISCOUNT_FLAG ,
TOTAL_ASSET_LOCAL ,
LE_TOTAL_ASSET_AMOUNT_EUR ,
COUNTRY_OF_RESIDENCE_RK ,
CRD4_MEMO_ITEMS_EXPOSURE_TYPE ,
MARKET_RISK_SUB_TYPE ,
PERS_ACC_FLAG ,
LE_FI_AVC_CATEGORY ,
B2_IRB_RWA_R_COR_COEFF ,
B2_IRB_RWA_K_CAPITAL_REQ_PRE ,
B2_IRB_RWA_K_CAPITAL_REQ_POST ,
SCALE_UP_COEFENT_OF_CORELATION ,
RRU_CODE ,
B3_CVA_CC_ADV_VAR_AVG ,
B3_CVA_CC_ADV_VAR_SPOT ,
B3_CVA_CC_ADV_VAR_STRESS_AVG ,
B3_CVA_CC_ADV_VAR_STRESS_SPOT ,
B3_CVA_CC_CAPITAL_AMT ,
B3_CVA_CC_RWA_AMT ,
B3_CVA_CC_CD_SNGL_NAM_NTNL_AMT ,
B3_CVA_CC_CDS_INDEX_NTNL_AMT ,
B2_ALGO_IRB_CORP_SME_FLAG ,
INDUSTRY_RK ,
STATUTORY_LEDGER_BALANCE ,
CARRYING_VALUE ,
RAFA_MAPPING_RK ,
LEVERAGE_EXPOSURE ,
CCB_COUNTRY_RK ,
COI_COUNTRY_RULE_RK ,
COO_COUNTRY_RULE_RK ,
COR_COUNTRY_RULE_RK ,
CCB_COUNTRY_RULE_RK ,
STANDALONE_ENTITY ,
RP_TURNOVER_SOURCE_TYPE ,
P3_PD_BAND_RK ,
EXP_SECURED_BY_COLLATERAL_AMT ,
EXP_SEC_BY_COLL_COVERED_AMT ,
EXP_SECURED_BY_GUARANTEES_AMT ,
EXP_SEC_BY_GUAR_COVERED_AMT ,
EXP_SECURED_BY_CRD_DRVS_AMT ,
EXP_SEC_BY_CRD_DRV_COVERED_AMT ,
P3_STD_ASSET_CLASS_RK ,
BLANK_CRM_CATEGORY_AMT ,
EXP_UNSECURED_CARRYING_AMT ,
CRD4_MEMO_ITEMS_ASSET_CLASS_RK ,
INTEREST_SUSPENSE_AMT_GBP ,
TOT_REGU_PROV_AMT_GBP ,
COREP_INCORP_COUNTRY_RK ,
NET_MKT_VAL ,
B2_APP_CAP_REQ_POST_CRM_AMT ,
LER_CHILD_COUNTERPARTY_RK ,
IG_EXCLUSION_FLAG ,
NEW_IN_DEFAULT_FLAG ,
RETAIL_POOL_SME_FLAG ,
B2_IRB_CCF ,
LTV_WHOLESALE ,
MITIGANT_CURRENT_FAC_VAL_GBP ,
FAC_FACILITY_RK ,
IMPAIRMENT_LOSS_GBP ,
GRDW_POOL_ID ,
GRDW_POOL_GROUP_ID ,
NEW_DFL_SINCE_LAST_REP_PRD_WS ,
DEAL_TYPE ,
LGD_MODEL_RK ,
LGD_CALC_MODE ,
DEFINITIVE_SLOT_CATEGORY_CALC ,
REPU_COMM_MORE_THAN_YEAR_GBP ,
REPU_COMM_LESS_THAN_YEAR_GBP ,
UNCOMM_UNDRAWN_AMT_GBP ,
TOTAL_UNDRAWN_AMOUNT_GBP ,
COLLECTIVELY_EVALUATED_FLAG ,
B2_STD_CREDIT_QUALITY_STEP ,
GL_ACCOUNT_RK ,
DRAWN_LEDGER_BALANCE ,
E_STAR_GROSS_EXPOSURE ,
GROSS_CARRYING_VALUE ,
B2_IRB_RWA_PRE_CDS ,
RA_AD_EXP ,
EAD_MODEL_RK ,
ORIGINAL_CURRENCY_CODE ,
ORIGINAL_TRADE_ID ,
COMM_REAL_ESTATE_SEC_FLAG ,
SECURITISATION_DETAIL_RK ,
LER_CREDIT_QUALITY_STEP ,
FSA_GROSS_EXPOSURE ,
FSA045_PD_BAND_RK ,
RISK_TAKER_RF_FLAG ,
RISK_TAKER_GS_CODE ,
RISK_ON_RF_FLAG ,
RISK_ON_GS_CODE ,
BORROWER_GS_CODE ,
ULTIMATE_RING_FENCE_PARENT_RK ,
COREP_INDUSTRY_RK ,
SUBG_CATEGORY_RK ,
LE_CPTY_SUBG_CATEGORY_RK ,
STS_SECURITISATION ,
STS_SEC_QUAL_CAP_TRTMNT ,
STS_SEC_APPROACH_CODE ,
B3_APP_RWA_INC_CVA_CC_AMT ,
IFRS9_TOT_REGU_ECL_AMT_GBP ,
IFRS9_FINAL_ECL_MES_GBP ,
IFRS9_FINAL_STAGE ,
IFRS9_STAGE_3_TYPE ,
IFRS9_FINAL_IIS_GBP , 
IFRS9_PROV_IMPAIRMENT_AMT_GBP ,
IFRS9_ECL_CURRENCY_CODE ,
IFRS9_PROV_WRITE_OFF_AMT_GBP , 
IFRS9_TOT_STATUT_ECL_AMT_GBP ,
IFRS9_DISCNT_UNWIND_AMT_GBP ,
B1_EAD_POST_CRM_AMT ,
B1_RISK_WEIGHT_RATIO ,
B1_RWA_PRE_CRM_AMT ,
B1_UNDRAWN_COMMITMENT_GBP ,
B2_IRB_EFFECTIVE_MATURITY_YRS ,
B2_IRB_RWA_PRE_CRM_AMT ,
B2_STD_RWA_PRE_CRM_AMT ,
E_STAR_NET_EXPOSURE ,
FACILITY_MATCHING_LEVEL ,
PRODUCT_FAMILY_CODE ,
CARTHESIS_REPORTING_ID ,
RESIDUAL_MATURITY_BAND_RK ,
RISK_TYPE ,
NGAAP_PROVISION_AMT_GBP ,
REP_PROVISION_AMT_GBP ,
C33_EXPOSURE_SECTOR ,
FINREP_COUNTERPARTY_SECTOR ,
IAS39_CLASS ,
REP_PROVISION_TYPE ,
SME_DISCOUNT_FACTOR ,
B2_STD_RWA_PRE_SPRT_AMT ,
B2_STD_RWA_PRE_SPRT_AMT_ONBAL ,
B2_STD_RWA_PRE_SPRT_AMT_OFBAL ,
RWA_POST_CRM_PRE_SPRT_AMOUNT ,
B2_IRB_RWA_PRE_SPRT_AMT_ONBAL ,
B2_IRB_RWA_PRE_SPRT_AMT_OFBAL ,
CRR2_501A_DISCOUNT_FLAG ,
MORTGAGES_FLAG ,
SECURITY_RK ,
B2_IRB_CRM_COD_AMT ,
B2_IRB_CRM_LIP_AMT ,
CAPITAL_CUTS ,
CRR2_FLAG ,
BASEL_SECURITY_SUB_TYPE ,
SYS_PROTECTION_TYPE,
YEAR_MONTH_RK from rtd_mart.fct_corep_crd4_stg;




=============================================================================================================

Static partition 

insert overwrite table rtd_mart.fct_corep_crd4 partition(YEAR_MONTH_RK=202106) select 
DEAL_ID ,
MITIGANT_ID ,
SYS_CODE , 
REPORTING_REGULATOR_CODE ,
WALKER_COST_CENTRE_RK ,
COUNTERPARTY_RK ,
LE_COUNTERPARTY_RK ,
WBU_COUNTERPARTY_RK ,
DIVISION_RK ,
INCORP_COUNTRY_RK ,
OP_COUNTRY_RK ,
RISK_COUNTRY_RK ,
BRANCH_COUNTRY_RK ,
B2_IRB_ASSET_CLASS_RK ,
COREP_ASSET_CLASS_RK ,
COREP_STD_ASSET_CLASS_RK ,
COREP_PRDEF_STD_ASSET_CLASS_RK ,
B2_STD_ASSET_CLASS_RK ,
PRODUCT_RK ,
COREP_PRODUCT_CATEGORY_RK ,
PD_MODEL_RK ,
COUNTERPARTY_MGS_PD_BAND_RK ,
CBI_PD_BAND_CODE_RK ,
MGS_PD_BAND_CODE_RK ,
RET_PD_BAND_CODE_RK ,
RRU_RK ,
RISK_ON_RRU_RK ,
UNSETTLED_PERIOD_CODE ,
UNSETTLED_FACTOR_CODE ,
RUN_RK ,
ACCRUED_INT_ONBAL_AMT ,
ACCRUED_INTEREST_GBP ,
ACLM_PRODUCT_TYPE ,
ADJUST_FLAG ,
REPORTING_TYPE_CODE ,
RWA_APPROACH_CODE ,
B1_RWA_POST_CRM_AMT ,
B2_APP_ADJUSTED_LGD_RATIO ,
B2_APP_ADJUSTED_PD_RATIO ,
B2_APP_EXPECTED_LOSS_AMT ,
B2_APP_RISK_WEIGHT_RATIO ,
B2_IRB_CRM_FCP_ELG_FIN_COL_AMT ,
B2_IRB_CRM_FCP_OTH_PHY_COL_AMT ,
B2_IRB_CRM_FCP_OTH_FUNDED_AMT ,
B2_IRB_CRM_FCP_REAL_ESTATE_AMT ,
B2_IRB_CRM_FCP_RECEIVABLES_AMT ,
B2_IRB_CRM_UFCP_CRED_DERIV_AMT ,
B2_IRB_CRM_UFCP_DOUBLE_DEF_AMT ,
B2_IRB_CRM_UFCP_GUAR_AMT ,
to_date(from_unixtime(unix_timestamp(B2_IRB_DEFAULT_DATE,'MM/dd/yyyy'))) as B2_IRB_DEFAULT_DATE,
B2_IRB_DRAWN_EAD ,
B2_IRB_DRAWN_EXPECTED_LOSS ,
B2_IRB_DRAWN_RWA ,
B2_IRB_EAD_AMT_OFBAL ,
B2_IRB_EAD_AMT_ONBAL ,
B2_IRB_EL_AMT_OFBAL ,
B2_IRB_EL_AMT_ONBAL ,
B2_IRB_NETTED_COLL_GBP ,
B2_IRB_OBSRVD_NEW_DEFAULT_FLAG ,
B2_STD_OBSRVD_NEW_DEFAULT_FLAG ,
B2_IRB_ORIG_EXP_PRE_CON_FACTOR ,
B2_IRB_PROVISIONS_AMT ,
B2_IRB_RWA_AMT_OFBAL ,
B2_IRB_RWA_AMT_ONBAL ,
B2_IRB_UNDRAWN_EAD ,
B2_IRB_UNDRAWN_EXPECTED_LOSS ,
B2_IRB_UNDRAWN_RWA ,
B2_STD_CCF ,
B2_STD_CCF_LESS_THAN_YEAR ,
B2_STD_CCF_MORE_THAN_YEAR ,
B2_STD_COLL_FX_HAIRCUT_AMT ,
B2_STD_COLL_VOLATILITY_AMT ,
B2_STD_CRM_TOT_INFLOW ,
B2_STD_CRM_TOT_INFLOW_OFBAL ,
B2_STD_CRM_TOT_INFLOW_ONBAL ,
B2_STD_CRM_TOT_INFLOW_RWA ,
B2_STD_CRM_TOT_OUTFLOW ,
B2_STD_CRM_TOT_OUTFLOW_OFBAL ,
B2_STD_CRM_TOT_OUTFLOW_ONBAL ,
B2_STD_CRM_TOT_OUTFLOW_RWA ,
to_date(from_unixtime(unix_timestamp(B2_STD_DEFAULT_DATE,'MM/dd/yyyy'))) as B2_STD_DEFAULT_DATE,
B2_STD_DRAWN_EAD ,
B2_STD_DRAWN_RWA ,
B2_STD_EAD_POST_CRM_AMT_OFBAL ,
B2_STD_EAD_POST_CRM_AMT_ONBAL ,
B2_STD_EFF_CDS_AMT ,
B2_STD_EFF_FIN_COLL_AMT ,
B2_STD_EFF_GTEE_AMT ,
B2_STD_COLL_MTY_MISMATCH_AMT ,
B2_STD_EXP_HAIRCUT_ADJ_AMT ,
B2_STD_EXPOSURE_VALUE ,
B2_STD_EXPOSURE_VALUE_OFBAL ,
B2_STD_EXPOSURE_VALUE_ONBAL ,
B2_STD_FULLY_ADJ_EXP ,
B2_STD_FULLY_ADJ_EXP_CCF_0 ,
B2_STD_FULLY_ADJ_EXP_CCF_100 ,
B2_STD_FULLY_ADJ_EXP_CCF_20 ,
B2_STD_FULLY_ADJ_EXP_CCF_50 ,
B2_STD_FULLY_ADJ_EXP_OFBAL ,
B2_STD_FULLY_ADJ_EXP_ONBAL ,
B2_STD_NET_EXP_POST_CRM_SUBST ,
STD_NET_EXP_POSTCRM_SUBT_OFBAL ,
STD_NET_EXP_POSTCRM_SUBT_ONBAL ,
B2_STD_NET_EXP_PRE_CRM_SUBST ,
STD_NET_EXP_PRECRM_SUBST_OFBAL ,
STD_NET_EXP_PRECRM_SUBST_ONBAL ,
B2_STD_NETTED_COLL_GBP ,
B2_STD_ORIG_EXP_PRE_CON_FACTOR ,
B2_STD_OTH_FUN_CRED_PROT_AMT ,
B2_STD_PROVISIONS_AMT ,
B2_STD_PROVISIONS_AMT_OFBAL ,
B2_STD_PROVISIONS_AMT_ONBAL ,
B2_STD_RISK_WEIGHT_INDICATOR ,
B2_STD_RISK_WEIGHT_RATIO ,
B2_STD_RWA_AMT ,
B2_STD_RWA_AMT_OFBAL ,
B2_STD_RWA_AMT_ONBAL ,
B2_STD_RWA_POST_CRM_AMT_OFBAL ,
B2_STD_RWA_POST_CRM_AMT_ONBAL ,
B2_STD_UNDRAWN_EAD ,
B2_STD_UNDRAWN_RWA ,
B3_CCP_MARGIN_INITL_CASH_AMT ,
B3_CCP_MARGIN_INITL_NOCASH_AMT ,
B3_CCP_MARGIN_INITL_RWA_AMT ,
B3_CCP_MARGIN_NONINITL_RWA_AMT ,
B3_CVA_CC_ADV_FLAG ,
B3_CVA_PROVISION_AMT ,
B3_CVA_PROVISION_RESIDUAL_AMT ,
BASEL_DATA_FLAG ,
COLL_GOOD_PROV_AMT ,
COMM_LESS_THAN_1_YEAR ,
COMM_LESS_THAN_1_YR_APPORTION ,
COMM_MORE_THAN_1_YEAR ,
COMM_MORE_THAN_1_YR_APPORTION ,
CRD4_REP_CVA_FLAG ,
CRD4_REP_IRB_FLAG ,
CRD4_REP_IRBEQ_FLAG ,
CRD4_REP_SETTL_FLAG ,
CRD4_REP_STD_FLAG ,
CRD4_REP_STDFLOW_FLAG ,
CVA_CHARGE ,
DEFAULT_FUND_CONTRIB_INDICATOR ,
DOUBLE_DEFAULT_FLAG ,
EAD_LGD_NUMERATOR ,
EAD_LGD_NUMERATOR_OFF ,
EAD_LGD_NUMERATOR_ON ,
EAD_MAT_YEARS_NUMERATOR ,
EAD_MAT_YEARS_NUMERATOR_OFF ,
EAD_MAT_YEARS_NUMERATOR_ON ,
EAD_PD_NUMERATOR ,
EAD_PD_NUMERATOR_OFF ,
EAD_PD_NUMERATOR_ON ,
EAD_POST_CRM_AMT ,
EAD_PRE_CRM_AMT ,
EXCH_RATE_EUR ,
EXCH_RATE_USD ,
FLOW_TYPE ,
GROSS_DEP_UTILISATION_AMT ,
IMP_IMPAIRMENT_AMT ,
IMP_WRITE_OFF_AMT ,
INTERNAL_TRANSACTION_FLAG ,
IRB_ORIG_EXP_PRE_CONV_OFBAL ,
IRB_ORIG_EXP_PRE_CONV_ONBAL ,
IRB_RISK_WEIGHT_RATIO ,
LRFE_UFE_FLAG ,
NET_DEP_UTILISATION_AMT ,
NET_EXPOSURE ,
NET_EXPOSURE_POST_SEC ,
OBLIGOR_TYPE ,
OFF_BAL_LED_EXP_GBP_POST_SEC ,
OFF_BALANCE_EXPOSURE ,
ON_BAL_LED_EXP_GBP_POST_SEC ,
ON_BALANCE_LEDGER_EXPOSURE ,
PAST_DUE_ASSET_FLAG ,
PROVISION_AMOUNT_GBP ,
QCCP_FLAG ,
RESIDUAL_MATURITY_DAYS ,
RESIDUAL_VALUE ,
RETAIL_OFF_BAL_SHEET_FLAG ,
RISK_ON_GROUP_STRUCTURE ,
RISK_TAKER_GROUP_STRUCTURE ,
RWA_CALC_METHOD ,
RWA_POST_CRM_AMOUNT ,
SECURITISED_FLAG ,
SET_OFF_INDICATOR ,
SLOTTING_RESIDUAL_MATURITY ,
SME_FLAG ,
SRT_FLAG ,
STD_ORIG_EXP_PRE_CONV_OFBAL ,
STD_ORIG_EXP_PRE_CONV_ONBAL ,
STD_RISK_WEIGHT_RATIO ,
TRADING_BOOK_FLAG ,
UNDRAWN_COMMITMENT_AMT ,
UNDRAWN_COMMITMENT_AMT_PST_SEC ,
UNSETTLED_AMOUNT ,
UNSETTLED_PRICE_DIFFERENCE_AMT ,
LEASE_EXPOSURE_GBP ,
LEASE_PAYMENT_VALUE_AMT ,
RETAIL_OBLIGOR_COUNT ,
STD_EXPOSURE_DEFAULT_FLAG , 
STD_EXP_TYPE_PRI_ORDER_RULE_RK ,
CRD4_SOV_SUBSTITUTION_FLAG ,
STD_RW_PRIORITY_ORDER_RULE_RK ,
UNLIKELY_PAY_FLAG ,
CRD4_STD_RP_SME_FLAG ,
CRD4_IRB_RP_SME_FLAG ,
STD_SME_DISCOUNT_APP_FLAG ,
IRB_SME_DISCOUNT_APP_FLAG ,
TRANSITIONAL_PORTFOLIO_FLAG ,
FULLY_COMPLETE_SEC_FLAG ,
SAF_FILM_LEASING_FLAG ,
PRINCIPAL_AMT ,
MTM ,
AMORTISATION_AMT ,
BSD_MARKER ,
EC92_CODE ,
B2_IRB_COLLTRL_AMT_TTC ,
B2_IRB_GARNTEE_AMT_TTC ,
SEC_DISCNT_B2_IRB_COLL_AMT_TTC ,
SEC_DISCNT_B2_IRB_GTEE_AMT_TTC ,
PARENT_COUNTERPARTY_RK ,
IMMOVABLE_PROP_INDICATOR ,
SLOTTING_EFF_MATURITY_BAND_RK ,
COREP_IRB_ASSET_CLASS_RK ,
ALTERNATIVE_STD_CCF_0 ,
ALTERNATIVE_STD_CCF_20 ,
ALTERNATIVE_STD_CCF_50 ,
ALTERNATIVE_STD_CCF_100 ,
COREP_CRM_REPORTING_FLAG ,
STD_ACT_RISK_WEIGHT ,
ABCP_FLAG ,
ACCOUNTING_TREATMENT ,
AVG_RW_PCT_IAA ,
B2_IRB_SEC_CQS_INCEPTION ,
B2_IRB_SEC_STRUC_AMT ,
B2_STD_SEC_CQS_AT_INCEPTION ,
CCP_RISK_WEIGHT ,
COMPLIANCE_RETENTION ,
CONDUIT_FLAG ,
CS_PROXY_USED_FLAG ,
DIRECT_CREDIT_SUBSTITUES ,
EARLY_AMORT_CONV_FACT_APPLIED ,
EARLY_AMORTISATION_FLAG ,
EXP_VAL_DEDUCTED_FROM_OWN_FUND ,
FUNDED_CREDIT_PROTECTION ,
MEMO_ITEMS_ELIG_LQ_FACILITIES ,
MEMO_ITEMS_IRS_CRS ,
MEMO_ITEMS_OTHERS ,
MEMO_ITEMS_OWN_FUND_OUTFLOW ,
NOTIONAL_OR_REPO_AMT ,
NUMBER_OF_EXPOSURES ,
to_date(from_unixtime(unix_timestamp(ORIGINATION_DATE,'MM/dd/yyyy'))) as ORIGINATION_DATE,
RETENTION_PCT ,
to_date(from_unixtime(unix_timestamp(SECN_FRST_FORESBL_TRMNATE_DATE,'MM/dd/yyyy'))) as SECN_FRST_FORESBL_TRMNATE_DATE,
SECN_GAAP_OTTI_AMT ,
SECN_IFRS_OTTI_AMT ,
to_date(from_unixtime(unix_timestamp(SECN_LEGAL_FINAL_MTY_DATE,'MM/dd/yyyy'))) as SECN_LEGAL_FINAL_MTY_DATE,
SECN_ORIG_COUNTERPARTY_RK ,
SECN_OTTI_CURRENCY ,
SECN_UNFUND_CRDT_PROTECT_AMT ,
SOLVENCY_TREATMENT ,
TOT_AMT_OF_SEC_EXP_ORIGINATED ,
to_date(from_unixtime(unix_timestamp(TOT_AMT_SEC_EXP_AT_REP_DATE,'MM/dd/yyyy'))) as TOT_AMT_SEC_EXP_AT_REP_DATE, 
TRADING_BOOK_CTP_OR_NON_CTP ,
TRADING_BOOK_NET_POS_LONG ,
TRADING_BOOK_NET_POS_SHORT ,
TRADING_BOOK_TOT_OWN_FUNDS ,
TYPE_OF_RETENTION_APPLIED ,
COUNTRY_UNDERLY_RISK_RK ,
FIN_COL ,
B2_IRB_INTEREST_AT_DEFAULT_GBP ,
PORTFOLIO ,
REIL_AMT_GBP ,
PROVISION_GRANULARITY ,
RECOVERIES_AMT_GBP ,
REIL_STATUS ,
PROV_MATCHED_FLAG ,
RP_TURNOVER_MAX_EUR ,
RP_TURNOVER_CCY ,
RP_SALES_TURNOVER_LOCAL ,
RP_SALES_TURNOVER_SOURCE ,
B3_SME_RP_FLAG ,
B3_SME_RP_IRB_CORP_FLAG ,
B3_SME_RP_1_5M_FLAG ,
B3_SME_DISCOUNT_FLAG ,
TOTAL_ASSET_LOCAL ,
LE_TOTAL_ASSET_AMOUNT_EUR ,
COUNTRY_OF_RESIDENCE_RK ,
CRD4_MEMO_ITEMS_EXPOSURE_TYPE ,
MARKET_RISK_SUB_TYPE ,
PERS_ACC_FLAG ,
LE_FI_AVC_CATEGORY ,
B2_IRB_RWA_R_COR_COEFF ,
B2_IRB_RWA_K_CAPITAL_REQ_PRE ,
B2_IRB_RWA_K_CAPITAL_REQ_POST ,
SCALE_UP_COEFENT_OF_CORELATION ,
RRU_CODE ,
B3_CVA_CC_ADV_VAR_AVG ,
B3_CVA_CC_ADV_VAR_SPOT ,
B3_CVA_CC_ADV_VAR_STRESS_AVG ,
B3_CVA_CC_ADV_VAR_STRESS_SPOT ,
B3_CVA_CC_CAPITAL_AMT ,
B3_CVA_CC_RWA_AMT ,
B3_CVA_CC_CD_SNGL_NAM_NTNL_AMT ,
B3_CVA_CC_CDS_INDEX_NTNL_AMT ,
B2_ALGO_IRB_CORP_SME_FLAG ,
INDUSTRY_RK ,
STATUTORY_LEDGER_BALANCE ,
CARRYING_VALUE ,
RAFA_MAPPING_RK ,
LEVERAGE_EXPOSURE ,
CCB_COUNTRY_RK ,
COI_COUNTRY_RULE_RK ,
COO_COUNTRY_RULE_RK ,
COR_COUNTRY_RULE_RK ,
CCB_COUNTRY_RULE_RK ,
STANDALONE_ENTITY ,
RP_TURNOVER_SOURCE_TYPE ,
P3_PD_BAND_RK ,
EXP_SECURED_BY_COLLATERAL_AMT ,
EXP_SEC_BY_COLL_COVERED_AMT ,
EXP_SECURED_BY_GUARANTEES_AMT ,
EXP_SEC_BY_GUAR_COVERED_AMT ,
EXP_SECURED_BY_CRD_DRVS_AMT ,
EXP_SEC_BY_CRD_DRV_COVERED_AMT ,
P3_STD_ASSET_CLASS_RK ,
BLANK_CRM_CATEGORY_AMT ,
EXP_UNSECURED_CARRYING_AMT ,
CRD4_MEMO_ITEMS_ASSET_CLASS_RK ,
INTEREST_SUSPENSE_AMT_GBP ,
TOT_REGU_PROV_AMT_GBP ,
COREP_INCORP_COUNTRY_RK ,
NET_MKT_VAL ,
B2_APP_CAP_REQ_POST_CRM_AMT ,
LER_CHILD_COUNTERPARTY_RK ,
IG_EXCLUSION_FLAG ,
NEW_IN_DEFAULT_FLAG ,
RETAIL_POOL_SME_FLAG ,
B2_IRB_CCF ,
LTV_WHOLESALE ,
MITIGANT_CURRENT_FAC_VAL_GBP ,
FAC_FACILITY_RK ,
IMPAIRMENT_LOSS_GBP ,
GRDW_POOL_ID ,
GRDW_POOL_GROUP_ID ,
NEW_DFL_SINCE_LAST_REP_PRD_WS ,
DEAL_TYPE ,
LGD_MODEL_RK ,
LGD_CALC_MODE ,
DEFINITIVE_SLOT_CATEGORY_CALC ,
REPU_COMM_MORE_THAN_YEAR_GBP ,
REPU_COMM_LESS_THAN_YEAR_GBP ,
UNCOMM_UNDRAWN_AMT_GBP ,
TOTAL_UNDRAWN_AMOUNT_GBP ,
COLLECTIVELY_EVALUATED_FLAG ,
B2_STD_CREDIT_QUALITY_STEP ,
GL_ACCOUNT_RK ,
DRAWN_LEDGER_BALANCE ,
E_STAR_GROSS_EXPOSURE ,
GROSS_CARRYING_VALUE ,
B2_IRB_RWA_PRE_CDS ,
RA_AD_EXP ,
EAD_MODEL_RK ,
ORIGINAL_CURRENCY_CODE ,
ORIGINAL_TRADE_ID ,
COMM_REAL_ESTATE_SEC_FLAG ,
SECURITISATION_DETAIL_RK ,
LER_CREDIT_QUALITY_STEP ,
FSA_GROSS_EXPOSURE ,
FSA045_PD_BAND_RK ,
RISK_TAKER_RF_FLAG ,
RISK_TAKER_GS_CODE ,
RISK_ON_RF_FLAG ,
RISK_ON_GS_CODE ,
BORROWER_GS_CODE ,
ULTIMATE_RING_FENCE_PARENT_RK ,
COREP_INDUSTRY_RK ,
SUBG_CATEGORY_RK ,
LE_CPTY_SUBG_CATEGORY_RK ,
STS_SECURITISATION ,
STS_SEC_QUAL_CAP_TRTMNT ,
STS_SEC_APPROACH_CODE ,
B3_APP_RWA_INC_CVA_CC_AMT ,
IFRS9_TOT_REGU_ECL_AMT_GBP ,
IFRS9_FINAL_ECL_MES_GBP ,
IFRS9_FINAL_STAGE ,
IFRS9_STAGE_3_TYPE ,
IFRS9_FINAL_IIS_GBP , 
IFRS9_PROV_IMPAIRMENT_AMT_GBP ,
IFRS9_ECL_CURRENCY_CODE ,
IFRS9_PROV_WRITE_OFF_AMT_GBP , 
IFRS9_TOT_STATUT_ECL_AMT_GBP ,
IFRS9_DISCNT_UNWIND_AMT_GBP ,
B1_EAD_POST_CRM_AMT ,
B1_RISK_WEIGHT_RATIO ,
B1_RWA_PRE_CRM_AMT ,
B1_UNDRAWN_COMMITMENT_GBP ,
B2_IRB_EFFECTIVE_MATURITY_YRS ,
B2_IRB_RWA_PRE_CRM_AMT ,
B2_STD_RWA_PRE_CRM_AMT ,
E_STAR_NET_EXPOSURE ,
FACILITY_MATCHING_LEVEL ,
PRODUCT_FAMILY_CODE ,
CARTHESIS_REPORTING_ID ,
RESIDUAL_MATURITY_BAND_RK ,
RISK_TYPE ,
NGAAP_PROVISION_AMT_GBP ,
REP_PROVISION_AMT_GBP ,
C33_EXPOSURE_SECTOR ,
FINREP_COUNTERPARTY_SECTOR ,
IAS39_CLASS ,
REP_PROVISION_TYPE ,
SME_DISCOUNT_FACTOR ,
B2_STD_RWA_PRE_SPRT_AMT ,
B2_STD_RWA_PRE_SPRT_AMT_ONBAL ,
B2_STD_RWA_PRE_SPRT_AMT_OFBAL ,
RWA_POST_CRM_PRE_SPRT_AMOUNT ,
B2_IRB_RWA_PRE_SPRT_AMT_ONBAL ,
B2_IRB_RWA_PRE_SPRT_AMT_OFBAL ,
CRR2_501A_DISCOUNT_FLAG ,
MORTGAGES_FLAG ,
SECURITY_RK ,
B2_IRB_CRM_COD_AMT ,
B2_IRB_CRM_LIP_AMT ,
CAPITAL_CUTS ,
CRR2_FLAG ,
BASEL_SECURITY_SUB_TYPE ,
SYS_PROTECTION_TYPE from rtd_mart.fct_corep_crd4_stg;



